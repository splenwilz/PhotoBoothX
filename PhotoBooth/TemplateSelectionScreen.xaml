<UserControl x:Class="Photobooth.TemplateSelectionScreen"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <UserControl.Resources>

        <!-- Main Background Gradient -->
        <LinearGradientBrush x:Key="MainBackgroundGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#581C87" Offset="0"/>
            <!-- purple-900 -->
            <GradientStop Color="#1E3A8A" Offset="0.5"/>
            <!-- blue-900 -->
            <GradientStop Color="#312E81" Offset="1"/>
            <!-- indigo-900 -->
        </LinearGradientBrush>

        <!-- Floating Orb Style -->
        <Style x:Key="FloatingOrbStyle" TargetType="Ellipse">
            <Setter Property="Effect">
                <Setter.Value>
                    <BlurEffect Radius="15"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Category Button Style -->
        <Style x:Key="CategoryButtonStyle" TargetType="Button">
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Color="White" Opacity="0.15"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="Margin" Value="8,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="20"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="White" Opacity="0.2"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="Tag" Value="Selected">
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="Foreground" Value="#581C87"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Template Card Style -->
        <Style x:Key="TemplateCardStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="16"
                                Effect="{TemplateBinding Effect}">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="20" Opacity="0.3" ShadowDepth="5"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="1.05" ScaleY="1.05"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.95" ScaleY="0.95"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Navigation Arrow Style -->
        <Style x:Key="NavArrowStyle" TargetType="Button">
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Color="White" Opacity="0.1"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="Width" Value="60"/>
            <Setter Property="Height" Value="60"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="30">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="White" Opacity="0.2"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.3"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Back Button Style -->
        <Style x:Key="BackButtonStyle" TargetType="Button">
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Color="White" Opacity="0.1"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Width" Value="60"/>
            <Setter Property="Height" Value="60"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="30">
                            <TextBlock Text="←" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="24"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="White" Opacity="0.2"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </UserControl.Resources>

    <!-- Main Container -->
    <Grid Background="{StaticResource MainBackgroundGradient}" ClipToBounds="True">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Header -->
            <RowDefinition Height="Auto"/>
            <!-- Title -->
            <RowDefinition Height="Auto"/>
            <!-- Categories -->
            <RowDefinition Height="*"/>
            <!-- Templates -->
            <RowDefinition Height="Auto"/>
            <!-- Pagination -->
            <RowDefinition Height="60"/>
            <!-- Bottom Spacing -->
        </Grid.RowDefinitions>

        <!-- Floating Orbs Layer -->
        <Canvas Name="FloatingOrbsCanvas">
            <Ellipse Width="96" Height="96" 
                     Fill="#A855F7" Opacity="0.2" 
                     Style="{StaticResource FloatingOrbStyle}"
                     Canvas.Left="128" Canvas.Top="128"/>
            <Ellipse Width="80" Height="80" 
                     Fill="#3B82F6" Opacity="0.25" 
                     Style="{StaticResource FloatingOrbStyle}"
                     Canvas.Right="160" Canvas.Top="80"/>
            <Ellipse Width="128" Height="128" 
                     Fill="#EC4899" Opacity="0.15" 
                     Style="{StaticResource FloatingOrbStyle}"
                     Canvas.Left="480" Canvas.Bottom="160"/>
            <Ellipse Width="80" Height="80" 
                     Fill="#06B6D4" Opacity="0.2" 
                     Style="{StaticResource FloatingOrbStyle}"
                     Canvas.Right="128" Canvas.Bottom="128"/>
        </Canvas>



        <!-- Header Row -->
        <Grid Grid.Row="0" Margin="40,40,40,20">
            <Button Style="{StaticResource BackButtonStyle}"
                    HorizontalAlignment="Left"
                    Click="BackButton_Click"/>
        </Grid>

        <!-- Title Section -->
        <StackPanel Grid.Row="1" HorizontalAlignment="Center" Margin="0,0,0,40">
            <TextBlock Text="Choose Your Template" 
                       FontSize="64" 
                       FontWeight="Bold" 
                       Foreground="White" 
                       HorizontalAlignment="Center"
                       Margin="0,0,0,16"/>
            <TextBlock Text="Select a design for your photo strip" 
                       FontSize="24" 
                       Foreground="#DDD6FE"
                       HorizontalAlignment="Center"/>
        </StackPanel>

        <!-- Category Filter Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Center"
                    Margin="0,0,0,60">
            <Button Content="All" Style="{StaticResource CategoryButtonStyle}" 
                    Click="CategoryButton_Click" Tag="Selected" Name="AllButton"/>
            <Button Content="Portrait" Style="{StaticResource CategoryButtonStyle}" 
                    Click="CategoryButton_Click" Name="PortraitButton"/>
            <Button Content="Landscape" Style="{StaticResource CategoryButtonStyle}" 
                    Click="CategoryButton_Click" Name="LandscapeButton"/>
            <Button Content="Classic" Style="{StaticResource CategoryButtonStyle}" 
                    Click="CategoryButton_Click" Name="ClassicButton"/>
            <Button Content="Fun" Style="{StaticResource CategoryButtonStyle}" 
                    Click="CategoryButton_Click" Name="FunButton"/>
            <Button Content="Holiday" Style="{StaticResource CategoryButtonStyle}" 
                    Click="CategoryButton_Click" Name="HolidayButton"/>
            <Button Content="Seasonal" Style="{StaticResource CategoryButtonStyle}" 
                    Click="CategoryButton_Click" Name="SeasonalButton"/>
        </StackPanel>

        <!-- Template Display Area -->
        <Grid Grid.Row="3" HorizontalAlignment="Center" VerticalAlignment="Center">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <!-- Left Arrow -->
                <ColumnDefinition Width="*"/>
                <!-- Templates -->
                <ColumnDefinition Width="Auto"/>
                <!-- Right Arrow -->
            </Grid.ColumnDefinitions>

            <!-- Left Navigation Arrow -->
            <Button Grid.Column="0" 
                    Style="{StaticResource NavArrowStyle}"
                    Content="‹"
                    VerticalAlignment="Center"
                    Margin="40,0,20,0"
                    Click="PreviousPage_Click"
                    Name="PrevButton"/>

            <!-- Template Cards Container -->
            <ItemsControl Grid.Column="1" 
                          Name="TemplatesContainer" 
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Button Style="{StaticResource TemplateCardStyle}"
                                Click="TemplateCard_Click"
                                Tag="{Binding}">
                            <Button.Effect>
                                <DropShadowEffect BlurRadius="10" Opacity="0.2" ShadowDepth="2"/>
                            </Button.Effect>

                            <!-- Template Card - THREE CONSISTENT SIZES -->
                            <Grid Name="TemplateCardContainer" 
                                  Width="{Binding DisplayWidth}" 
                                  Height="{Binding DisplayHeight}"
                                  Margin="20">

                                <!-- Main Template Image Container -->
                                <Border CornerRadius="16" ClipToBounds="True">
                                    <Image Source="{Binding PreviewImagePath}" 
                                           Stretch="UniformToFill"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                                </Border>

                                <!-- Aspect Ratio Badge - Top Left -->
                                <Border Background="#581C87" 
                                        CornerRadius="8"
                                        Padding="8,4"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Margin="12">
                                    <TextBlock Text="{Binding AspectRatioText}" 
                                               Foreground="White" 
                                               FontSize="10"
                                               FontWeight="SemiBold"/>
                                </Border>

                                <!-- Category Badge - Top Right -->
                                <Border Background="#000000" 
                                        Opacity="0.8"
                                        CornerRadius="12"
                                        Padding="8,4"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Top"
                                        Margin="12">
                                    <TextBlock Text="{Binding Category}" 
                                               Foreground="White" 
                                               FontSize="10"
                                               FontWeight="SemiBold"/>
                                </Border>

                                <!-- Template Info Overlay - Bottom with dynamic sizing -->
                                <Border Background="#000000" 
                                        Opacity="0.85"
                                        CornerRadius="0,0,16,16"
                                        VerticalAlignment="Bottom"
                                        HorizontalAlignment="Stretch"
                                        MinHeight="60"
                                        MaxHeight="80">
                                    <StackPanel Margin="12,8" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding TemplateName}" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   Foreground="White"
                                                   Margin="0,0,0,2"
                                                   TextTrimming="CharacterEllipsis"/>
                                        <TextBlock Text="{Binding Description}" 
                                                   FontSize="10" 
                                                   Foreground="#CCCCCC"
                                                   TextWrapping="Wrap"
                                                   TextTrimming="CharacterEllipsis"
                                                   MaxHeight="32"/>
                                        <TextBlock Text="{Binding DimensionText}" 
                                                   FontSize="8" 
                                                   Foreground="#AAAAAA"
                                                   Margin="0,2,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </Button>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Right Navigation Arrow -->
            <Button Grid.Column="2" 
                    Style="{StaticResource NavArrowStyle}"
                    Content="›"
                    VerticalAlignment="Center"
                    Margin="20,0,40,0"
                    Click="NextPage_Click"
                    Name="NextButton"/>
        </Grid>

        <!-- Pagination Dots -->
        <StackPanel Grid.Row="4" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Center"
                    Margin="0,40,0,0"
                    Name="PaginationDots">
            <!-- Dots will be added programmatically -->
        </StackPanel>

        <!-- Page Info -->
        <TextBlock Grid.Row="4"
                   Text="Page 1 of 3"
                   FontSize="16"
                   Foreground="#DDD6FE"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Bottom"
                   Margin="0,0,0,20"
                   Name="PageInfo"/>

    </Grid>

</UserControl>